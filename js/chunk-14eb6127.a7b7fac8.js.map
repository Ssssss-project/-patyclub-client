{"version":3,"sources":["webpack:///./src/views/ResetPassword.vue","webpack:///./src/views/ResetPassword.vue?7b90","webpack:///./src/views/ResetPassword.vue?a67f"],"names":["horizontal","class","to","src","width","resetPassowrd","style","align","outlined","sPassword","type","bIsPwd","label","lazy-rules","rules","append","name","hide-bottom-space","sConfirmPassword","val","setup","$q","router","route","token","value","params","Ajv","ajv","passwordSchema","pattern","passwordValidate","compile","passowrdValidateHandler","valid","console","log","errors","newPwd","then","notify","icon","color","message","push","path","catch","textColor","render","QCardSection","QImg","QForm","QInput","QIcon","QBtn"],"mappings":"gKAYY,eAAyB,aAAlB,cAAU,G,6PAX3B,eAsDM,YArDJ,eAoDiB,GApDDA,WAAA,IAAU,C,wBACxB,iBAIiB,CAJjB,eAIiB,GAJDC,MAAM,QAAM,C,wBAC1B,iBAEc,CAFd,eAEc,GAFAC,GAAE,KAAK,C,wBACnB,iBAAoD,CAApD,eAAoD,GAA7CC,IAAA,IAA6BC,MAAM,c,gBAI9C,eA4CiB,GA5CDH,MAAM,SAAO,C,wBAC3B,iBA0CS,CA1CT,eA0CS,GA1CA,SAAM,+BAAE,EAAAI,kBAAiBC,MAAA,e,yBAChC,iBAoCiB,CApCjB,eAoCiB,GApCDC,MAAM,QAAM,C,wBAC1B,iBAAyB,CAAzB,EACA,eAkBU,GAjBRC,SAAA,G,WACS,EAAAC,U,qDAAA,EAAAA,UAAS,IACjBC,KAAM,EAAAC,OAAM,kBACbC,MAAM,OACNC,aAAA,GACCC,MAAK,C,SAAsB,G,OAA4B,GAAO,EAAI,OAAM,GAAQ,6B,mBAK/DC,OAAM,gBACtB,iBAIE,CAJF,eAIE,GAHCC,KAAM,EAAAL,OAAM,8BACbV,MAAM,iBACL,QAAK,+BAAE,EAAAU,QAAU,EAAAA,U,2DAIxB,eAcU,GAbRH,SAAA,GACAS,oBAAA,G,WACS,EAAAC,iB,qDAAA,EAAAA,iBAAgB,IACxBR,KAAM,EAAAC,OAAM,kBACbC,MAAM,SACLE,MAAK,UAAIK,GAAJ,OAAYA,IAAQ,EAAAV,WAAS,gB,CACjBM,OAAM,gBACtB,iBAIE,CAJF,eAIE,GAHCC,KAAM,EAAAL,OAAM,8BACbV,MAAM,iBACL,QAAK,+BAAE,EAAAU,QAAU,EAAAA,U,qEAM1B,eAEiB,GAFDJ,MAAM,UAAQ,C,wBAC5B,iBAAkC,CAAlC,eAAkC,GAA3BK,MAAM,KAAKF,KAAK,e,8EAcpB,GACbU,MADa,WAEX,IAAMC,EAAK,iBAELC,EAAS,iBACTC,EAAQ,iBACRC,EAAQ,eAAI,IAGZb,EAAS,gBAAI,GACbF,EAAY,eAAI,IAChBS,EAAmB,eAAI,IAG7B,gBAAU,kBAAOM,EAAMC,MAAQF,EAAMG,OAAOF,SAG5C,IAAMG,EAAM,EAAQ,QACdC,EAAM,IAAID,EAGVE,EAAiB,CACrBnB,KAAM,SACNoB,QAAS,4CAILC,EAAmBH,EAAII,QAAQH,GAGrC,SAASI,IACP,IAAMC,EAAQH,EAAiBtB,EAAUgB,OAEzC,OADKS,GAAOC,QAAQC,IAAIL,EAAiBM,QAClCH,EAIT,SAAS7B,IACP8B,QAAQC,IAAI,SAAWZ,EAAMC,OAC7BU,QAAQC,IAAI,YAAc3B,EAAUgB,OACpC,eAAe,CACbD,MAAOA,EAAMC,MACba,OAAQ7B,EAAUgB,QAEjBc,MAAK,WACJlB,EAAGmB,OAAO,CACRC,KAAM,OACNC,MAAO,WACPC,QAAS,iBAEXrB,EAAOsB,KAAK,CAAEC,KAAM,SAErBC,OAAM,WACLzB,EAAGmB,OAAO,CACRE,MAAO,QACPK,UAAW,QACXN,KAAM,UACNE,QAAS,iBAEXrB,EAAOsB,KAAK,CAAEC,KAAM,SAI1B,MAAO,CACLlC,SACAF,YACAS,mBACAe,0BACA5B,mB,yGC/HN,EAAO2C,OAASA,EAED,eAQf,IAAS,EAAQ,aAAc,CAACC,eAAA,KAAaC,OAAA,KAAKC,QAAA,KAAMC,SAAA,KAAOC,QAAA,KAAMC,OAAA,Q,oCCfrE,W","file":"js/chunk-14eb6127.a7b7fac8.js","sourcesContent":["<template>\r\n  <div>\r\n    <q-card-section horizontal>\r\n      <q-card-section class=\"card\">\r\n        <router-link :to=\"`/`\">\r\n          <q-img src=\"../assets/PatyLogo.png\" width=\"350px\" />\r\n        </router-link>\r\n      </q-card-section>\r\n\r\n      <q-card-section class=\"card1\">\r\n        <q-form @submit=\"resetPassowrd()\" style=\"width:80%\">\r\n          <q-card-section align=\"left\">\r\n            <label>密碼設定(至少六碼)</label>\r\n            <q-input\r\n              outlined\r\n              v-model=\"sPassword\"\r\n              :type=\"bIsPwd ? 'password' : 'text'\"\r\n              label=\"輸入密碼\"\r\n              lazy-rules\r\n              :rules=\"[\r\n                (val) =>\r\n                  (val && val.length > 0 && passowrdValidateHandler()) ||\r\n                  '請包含大小寫字母以及數字',\r\n              ]\"\r\n              ><template v-slot:append>\r\n                <q-icon\r\n                  :name=\"bIsPwd ? 'visibility_off' : 'visibility'\"\r\n                  class=\"cursor-pointer\"\r\n                  @click=\"bIsPwd = !bIsPwd\"\r\n                />\r\n              </template>\r\n            </q-input>\r\n            <q-input\r\n              outlined\r\n              hide-bottom-space\r\n              v-model=\"sConfirmPassword\"\r\n              :type=\"bIsPwd ? 'password' : 'text'\"\r\n              label=\"再次確認密碼\"\r\n              :rules=\"[(val) => val === sPassword || '密碼不符，請再次確認']\"\r\n              ><template v-slot:append>\r\n                <q-icon\r\n                  :name=\"bIsPwd ? 'visibility_off' : 'visibility'\"\r\n                  class=\"cursor-pointer\"\r\n                  @click=\"bIsPwd = !bIsPwd\"\r\n                />\r\n              </template>\r\n            </q-input>\r\n          </q-card-section>\r\n\r\n          <q-card-section align=\"center\">\r\n            <q-btn label=\"送出\" type=\"submit\" />\r\n          </q-card-section>\r\n        </q-form>\r\n      </q-card-section>\r\n    </q-card-section>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { ref, onMounted } from \"vue\";\r\nimport { apiPutResetPwd } from \"@/apis/api/userRequest.ts\";\r\nimport { useQuasar } from \"quasar\";\r\n\r\nexport default {\r\n  setup() {\r\n    const $q = useQuasar();\r\n\r\n    const router = useRouter();\r\n    const route = useRoute();\r\n    const token = ref(\"\");\r\n\r\n    // passowrd\r\n    const bIsPwd = ref(true);\r\n    const sPassword = ref(\"\");\r\n    const sConfirmPassword = ref(\"\");\r\n\r\n    // 取得tokebn\r\n    onMounted(() => (token.value = route.params.token));\r\n\r\n    // import ajv 驗證\r\n    const Ajv = require(\"ajv\");\r\n    const ajv = new Ajv();\r\n\r\n    // 定義ajv schema\r\n    const passwordSchema = {\r\n      type: \"string\",\r\n      pattern: \"^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$\",\r\n    };\r\n\r\n    // 編譯schema\r\n    const passwordValidate = ajv.compile(passwordSchema);\r\n\r\n    // 驗證密碼function\r\n    function passowrdValidateHandler() {\r\n      const valid = passwordValidate(sPassword.value);\r\n      if (!valid) console.log(passwordValidate.errors);\r\n      return valid;\r\n    }\r\n\r\n    // 重設密碼functtion\r\n    function resetPassowrd() {\r\n      console.log(\"token:\" + token.value);\r\n      console.log(\"password:\" + sPassword.value);\r\n      apiPutResetPwd({\r\n        token: token.value,\r\n        newPwd: sPassword.value,\r\n      })\r\n        .then(() => {\r\n          $q.notify({\r\n            icon: \"done\",\r\n            color: \"positive\",\r\n            message: \"密碼修改成功，請重新登入\",\r\n          });\r\n          router.push({ path: \"/\" });\r\n        })\r\n        .catch(() => {\r\n          $q.notify({\r\n            color: \"red-5\",\r\n            textColor: \"white\",\r\n            icon: \"warning\",\r\n            message: \"憑證過期，請重新發送信件\",\r\n          });\r\n          router.push({ path: \"/\" });\r\n        });\r\n    }\r\n\r\n    return {\r\n      bIsPwd,\r\n      sPassword,\r\n      sConfirmPassword,\r\n      passowrdValidateHandler,\r\n      resetPassowrd,\r\n    };\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\">\r\n.card {\r\n  background-color: lightgray;\r\n  height: 750px;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.card1 {\r\n  height: 750px;\r\n  width: 100%;\r\n  display: flex;\r\n  justify-content: left;\r\n  align-items: center;\r\n}\r\n</style>\r\n","import { render } from \"./ResetPassword.vue?vue&type=template&id=7d5167c6\"\nimport script from \"./ResetPassword.vue?vue&type=script&lang=js\"\nexport * from \"./ResetPassword.vue?vue&type=script&lang=js\"\n\nimport \"./ResetPassword.vue?vue&type=style&index=0&id=7d5167c6&lang=scss\"\nscript.render = render\n\nexport default script\nimport QCardSection from 'quasar/src/components/card/QCardSection.js';\nimport QImg from 'quasar/src/components/img/QImg.js';\nimport QForm from 'quasar/src/components/form/QForm.js';\nimport QInput from 'quasar/src/components/input/QInput.js';\nimport QIcon from 'quasar/src/components/icon/QIcon.js';\nimport QBtn from 'quasar/src/components/btn/QBtn.js';\nimport qInstall from \"../../node_modules/vue-cli-plugin-quasar/lib/runtime.auto-import.js\";\nqInstall(script, 'components', {QCardSection,QImg,QForm,QInput,QIcon,QBtn});\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/vue-cli-plugin-quasar/lib/loader.vue.auto-import-quasar.js??ref--0-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-1!../../node_modules/vue-loader-v16/dist/index.js??ref--0-2!./ResetPassword.vue?vue&type=style&index=0&id=7d5167c6&lang=scss\""],"sourceRoot":""}